---
title: 5.4 정리
date: 2022-11-02
type:  blog
author: harris baek
email: baekjh09@naver.com
---
tags: #spring , #backend , #db, #jpa 


### 양방향 매핑

1. 연관관계의 주인을 정해줘야 한다.
- 항상 "다(N)" 쪽이 주인이 된다. -> @ManyToOne 어노테이션 붙는 쪽이 주인
- 주인이 아닌 곳은 `mappedBy`로 표시해준다.

2. 연관관계의 주인이 아니면 읽기만 가능하다.
3. 연관관계의 주인만이 데이터를 변경시킬 수 있다.
4. 순수한 객체까지 고려하여 연관관계를 매핑해준다.
	- 주인이 아닌쪽에도 데이터를 추가해 준다.
	- 객체 관점에서 양쪽에 데이터를 추가해 주지 않으면 에러가 발생할 수 있기 때문
5. 양방향의 장점은 반대반향으로도 객체 그래프 탐색 기능이 추가되었다는것
	- 이전까지는 단방향 참조로 객체 그래프 탐색이 가능했음
6. 양방향 연관관계 매핑 시 연관관계 편의 메소드를 작성하여 사용한다.
	- 실수할 가능성을 줄이기 위해 양쪽 객체에 추가해주는 작업을 하나의 메소드로 관리한다.
	- 다(N) 쪽 연관관계 편의 메소드 로직에서 만약 기존 관계가 있다면 제거해주는 로직을 작성한다.
7. 다대일 연관관계에서 꼭 양방향일 필요는 없다.
	- 만약 한 쪽에서만 참조할 경우 단방향 다대일 연관관계를 사용하면 된다.
	- 굳이 양방향을 쓰지 않아도 된다.
	- 양쪽에 다른 엔티티의 참조를 가지면 양방향
	- 한쪽에만 다른 엔티티의 참조를 가지면 단방향
	- 단방향 다대일의 경우, 다(N) 쪽에 다른 엔티티를 가지면 @ManyToOne을 가지지만 (1) 쪽에서는 다(N)쪽 엔티티를 갖지 않는다 (양방향이 아니니까)

> 다(N) 쪽에서 @ManyToOne 이 붙고 @JoinColumn을 한다고 해서 일(1) 쪽에서 항상 @OneToMany를 붙여주는건 아니다.

### 연관관계의 주인을 정하는 기준

연관관계의 주인은 아래 키의 위치와 관련해서 정해야지, 비지니스 중요도로 접근하면 안된다.
ex) 자동차의 차체와 바퀴에서 바퀴가 외래 키가 있는 다쪽이다.

>