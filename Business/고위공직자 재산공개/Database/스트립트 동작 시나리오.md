## 0. 파일 변환 및 이름 변경
1. PDF파일을 받아서 첫번째로 유료로 엑셀로 변환한다.
2. 엑셀파일의 이름을 수동으로 그 날짜로 변경한다.
	[파일발행날짜]정부or국회_파일변경.xlsx
	[2019-03-28]정부_49_57.xlsx


## 1. 엑셀 전처리
기존에 엑셀에 있는 이상한 데이터들을 삭제하거나 수정한다.
(1) 국회 엑셀에 있는 맨 밑에 라인 페이지 이름 적힌 라인 제거 필요
	prop_script/checker/checker/delete_pagenum()

(2) 입력이 되지않고 비어있는 재산 셀(원래 하나에 있어야 되는데 2개로 나눠짐)을 찾아서 출력 후 , 수동으로 합쳐줘야함
	prop_script/checker/checker/find_onecell(), find_empty()



## 2. 엑셀 파싱
엑셀을 파싱해서 JSON으로 변환한다. 이때 엑셀에 기입된 사람 하나당 엑셀파일 하나가 나오게 되고, 파일 이름은  **이름_팀_직책_시간_파일이름_테이블번호.json** 이다


제약 사항 :
1.가격이나 구하지 못한값의 Default 는 0 이다. (이론적으로 0은 없다)

	prop_script/convert/parse.py
```python
def parse():
	input_folder = select_folder()
	files = os.listdir(input_folder)
	files.sort()
	
	for file in files:
		print(f"---------------------{file}-----------------------")
	try:
		parser = PropParser(os.path.join(input_folder, file))
		parser.parse()
	except Exception as e:
		print(f"error - {parser.filename}, {parser.cur_sheet},{e}")
		exit()
```


## 3. 동명이인 합치기
같은 년도 안에서 동명이인 있는지 찾아서 합친 후 에 하나의 JSON으로 Merge 한다.

	prop_script/convert/merge.py
```python
def merge():
merger = PropMerger(PropParser.output_folder)
merger.merge()
```


## 4. DB 에 머지된 데이터 삽입
이제 머지된 데이터를 DB에 삽입한다.

```ad-error
title: 주의
DB에 이미 같은 사람이 존재 할 수 도 있으므로, 

**1.DB 이름 검색, 2. 그사람의 자산 리스트 확인, 3. 자산 비교 후** 

동명 이인이 있으면 그사람 아이디로 디비 삽입
없으면 새로 삽입
```


```python
def to_db():
	person_db = PropertyDB()
	person_db.start(PropMerger.output_folder)
```
